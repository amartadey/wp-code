<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WP Troubleshooting Code Hub</title>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 20px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .search-box {
            background: white;
            border-radius: 50px;
            padding: 15px 25px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 16px;
        }

        .categories {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
            justify-content: center;
        }

        .category-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-btn:hover, .category-btn.active {
            background: white;
            color: #667eea;
            transform: translateY(-2px);
        }

        .snippets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .snippet-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
        }

        .snippet-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .snippet-header {
            display: flex;
            align-items: start;
            gap: 15px;
            margin-bottom: 15px;
        }

        .snippet-icon {
            font-size: 32px;
            color: #667eea;
            flex-shrink: 0;
        }

        .snippet-title {
            flex: 1;
        }

        .snippet-title h3 {
            color: #2d3748;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .snippet-category {
            display: inline-block;
            background: #e6f0ff;
            color: #667eea;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .snippet-description {
            color: #4a5568;
            margin-bottom: 15px;
            line-height: 1.6;
            flex: 1;
        }

        .code-block {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            position: relative;
            margin-bottom: 10px;
        }

        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .copy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.3s;
            align-self: flex-start;
        }

        .copy-btn:hover {
            background: #5568d3;
        }

        .copy-btn.copied {
            background: #48bb78;
        }

        .no-results {
            text-align: center;
            color: white;
            font-size: 1.2em;
            padding: 40px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .snippets-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <span class="iconify" data-icon="logos:wordpress-icon"></span>
                WP Troubleshooting Hub
            </h1>
            <p class="subtitle">Essential WordPress code snippets for debugging custom projects</p>
        </header>

        <div class="search-box">
            <span class="iconify" data-icon="carbon:search" style="color: #667eea; font-size: 20px;"></span>
            <input type="text" id="searchInput" placeholder="Search snippets...">
        </div>

        <div class="categories">
            <button class="category-btn active" data-category="all">
                <span class="iconify" data-icon="carbon:grid"></span>
                All
            </button>
            <button class="category-btn" data-category="debug">
                <span class="iconify" data-icon="carbon:debug"></span>
                Debug
            </button>
            <button class="category-btn" data-category="templates">
                <span class="iconify" data-icon="carbon:document"></span>
                Templates
            </button>
            <button class="category-btn" data-category="hooks">
                <span class="iconify" data-icon="carbon:flow"></span>
                Hooks
            </button>
            <button class="category-btn" data-category="database">
                <span class="iconify" data-icon="carbon:data-base"></span>
                Database
            </button>
            <button class="category-btn" data-category="user">
                <span class="iconify" data-icon="carbon:user"></span>
                User
            </button>
            <button class="category-btn" data-category="performance">
                <span class="iconify" data-icon="carbon:dashboard"></span>
                Performance
            </button>
        </div>

        <div class="snippets-grid" id="snippetsGrid"></div>
        <div class="no-results" id="noResults" style="display: none;">No snippets found</div>
    </div>

    <script>
        const snippets = [
            {
                title: "Which Template is Being Used?",
                category: "templates",
                icon: "carbon:document-view",
                description: "Display the current template file being loaded in the page source (visible only to administrators).",
                code: `add_action('wp_head', function() {
    if (current_user_can('administrator')) {
        global $template;
        echo '<!-- Template: ' . basename($template) . ' -->';
    }
});`
            },
            {
                title: "Enable WP Debug Mode",
                category: "debug",
                icon: "carbon:debug",
                description: "Add to wp-config.php to enable debug mode and log errors to debug.log file.",
                code: `define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
@ini_set('display_errors', 0);`
            },
            {
                title: "Show All Registered Hooks",
                category: "hooks",
                icon: "carbon:flow",
                description: "Display all hooks that have been registered on the current page.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wp_filter;
        echo '<pre>';
        print_r($wp_filter);
        echo '</pre>';
    }
});`
            },
            {
                title: "Display Query Variables",
                category: "debug",
                icon: "carbon:search",
                description: "Show the current WP_Query variables for debugging query issues.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wp_query;
        echo '<!--';
        print_r($wp_query->query_vars);
        echo '-->';
    }
});`
            },
            {
                title: "Log Database Queries",
                category: "database",
                icon: "carbon:data-base",
                description: "Enable query logging and display all database queries at the footer.",
                code: `// Add to wp-config.php
define('SAVEQUERIES', true);

// Add to theme
add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wpdb;
        echo '<pre>';
        print_r($wpdb->queries);
        echo '</pre>';
    }
});`
            },
            {
                title: "Show Template Hierarchy",
                category: "templates",
                icon: "carbon:tree-view",
                description: "Display which templates WordPress is looking for in the template hierarchy.",
                code: `add_filter('template_include', function($template) {
    if (current_user_can('administrator')) {
        global $wp_query;
        echo '<!-- Template Hierarchy: ';
        print_r($wp_query->query_vars);
        echo ' Using: ' . basename($template) . ' -->';
    }
    return $template;
});`
            },
            {
                title: "Display Current User Roles",
                category: "user",
                icon: "carbon:user-role",
                description: "Show all roles and capabilities for the current logged-in user.",
                code: `add_action('wp_footer', function() {
    if (is_user_logged_in()) {
        $user = wp_get_current_user();
        echo '<!-- User Roles: ';
        print_r($user->roles);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Registered Menus",
                category: "templates",
                icon: "carbon:menu",
                description: "Display all registered navigation menus and their locations.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $menus = get_registered_nav_menus();
        echo '<!-- Registered Menus: ';
        print_r($menus);
        echo ' -->';
    }
});`
            },
            {
                title: "Display Enqueued Scripts & Styles",
                category: "debug",
                icon: "carbon:code",
                description: "List all enqueued scripts and stylesheets on the current page.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wp_scripts, $wp_styles;
        echo '<!-- Scripts: ';
        print_r($wp_scripts->queue);
        echo ' Styles: ';
        print_r($wp_styles->queue);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Post Meta Data",
                category: "debug",
                icon: "carbon:document-tasks",
                description: "Display all custom fields/meta data for the current post.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator') && is_singular()) {
        $post_meta = get_post_meta(get_the_ID());
        echo '<!-- Post Meta: ';
        print_r($post_meta);
        echo ' -->';
    }
});`
            },
            {
                title: "Display Active Plugins",
                category: "debug",
                icon: "carbon:plug",
                description: "Show a list of all currently active plugins.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $plugins = get_option('active_plugins');
        echo '<!-- Active Plugins: ';
        print_r($plugins);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Current Sidebar Widgets",
                category: "templates",
                icon: "carbon:grid-view",
                description: "Display all widgets registered in each sidebar.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wp_registered_sidebars;
        echo '<!-- Sidebars: ';
        print_r($wp_registered_sidebars);
        echo ' -->';
    }
});`
            },
            {
                title: "Memory Usage Tracker",
                category: "performance",
                icon: "carbon:dashboard",
                description: "Display current memory usage and peak memory usage.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        echo '<!-- Memory: ' . 
             size_format(memory_get_usage()) . 
             ' | Peak: ' . 
             size_format(memory_get_peak_usage()) . 
             ' -->';
    }
});`
            },
            {
                title: "Query Monitor (Manual)",
                category: "performance",
                icon: "carbon:analytics",
                description: "Display page generation time and number of queries.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wpdb;
        echo '<!-- Queries: ' . $wpdb->num_queries . 
             ' | Time: ' . timer_stop() . 's -->';
    }
});`
            },
            {
                title: "Show Rewrite Rules",
                category: "debug",
                icon: "carbon:link",
                description: "Display all WordPress rewrite rules for debugging permalink issues.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $wp_rewrite;
        echo '<!-- Rewrite Rules: ';
        print_r($wp_rewrite->rules);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Conditional Tags",
                category: "templates",
                icon: "carbon:tag",
                description: "Display which conditional tags are true for the current page.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $conditionals = [
            'is_home', 'is_front_page', 'is_single', 
            'is_page', 'is_archive', 'is_category'
        ];
        $active = [];
        foreach($conditionals as $cond) {
            if($cond()) $active[] = $cond;
        }
        echo '<!-- Conditionals: ' . implode(', ', $active) . ' -->';
    }
});`
            },
            {
                title: "Display Current Taxonomy Terms",
                category: "templates",
                icon: "carbon:classifier",
                description: "Show all taxonomy terms for the current post.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator') && is_singular()) {
        $taxonomies = get_post_taxonomies();
        $terms = [];
        foreach($taxonomies as $tax) {
            $terms[$tax] = wp_get_post_terms(get_the_ID(), $tax);
        }
        echo '<!-- Terms: ';
        print_r($terms);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Body Classes",
                category: "templates",
                icon: "carbon:document-blank",
                description: "Display all body classes WordPress is adding to the current page.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $classes = get_body_class();
        echo '<!-- Body Classes: ' . implode(', ', $classes) . ' -->';
    }
});`
            },
            {
                title: "Display Current User Capabilities",
                category: "user",
                icon: "carbon:security",
                description: "Show all capabilities for the currently logged-in user.",
                code: `add_action('wp_footer', function() {
    if (is_user_logged_in() && current_user_can('administrator')) {
        $user = wp_get_current_user();
        echo '<!-- User Caps: ';
        print_r($user->allcaps);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Custom Post Type Details",
                category: "debug",
                icon: "carbon:data-class",
                description: "Display all registered custom post types and their settings.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $post_types = get_post_types(['_builtin' => false], 'objects');
        echo '<!-- Custom Post Types: ';
        print_r($post_types);
        echo ' -->';
    }
});`
            },
            {
                title: "Display Image Sizes",
                category: "debug",
                icon: "carbon:image",
                description: "Show all registered image sizes in WordPress.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $_wp_additional_image_sizes;
        echo '<!-- Image Sizes: ';
        print_r($_wp_additional_image_sizes);
        echo ' -->';
    }
});`
            },
            {
                title: "Show Global Variables",
                category: "debug",
                icon: "carbon:data-reference",
                description: "Display common WordPress global variables for debugging.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        global $post, $wp_query, $wpdb;
        echo '<!-- Globals - Post ID: ' . (isset($post) ? $post->ID : 'none') . 
             ' | Query Vars: ' . count($wp_query->query_vars) . 
             ' | DB Queries: ' . $wpdb->num_queries . ' -->';
    }
});`
            },
            {
                title: "Display Theme Directory Path",
                category: "templates",
                icon: "carbon:folder",
                description: "Show the current theme's directory paths for debugging.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        echo '<!-- Theme: ' . get_stylesheet_directory() . 
             ' | Parent: ' . get_template_directory() . ' -->';
    }
});`
            },
            {
                title: "Show Current Page ID",
                category: "debug",
                icon: "carbon:identification",
                description: "Display the current page/post ID and type.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $id = get_queried_object_id();
        $type = get_post_type($id);
        echo '<!-- Page ID: ' . $id . ' | Type: ' . $type . ' -->';
    }
});`
            },
            {
                title: "Display Cron Jobs",
                category: "debug",
                icon: "carbon:time",
                description: "Show all scheduled WordPress cron jobs.",
                code: `add_action('wp_footer', function() {
    if (current_user_can('administrator')) {
        $cron = _get_cron_array();
        echo '<!-- Cron Jobs: ';
        print_r($cron);
        echo ' -->';
    }
});`
            }
        ];

        function renderSnippets(filteredSnippets) {
            const grid = document.getElementById('snippetsGrid');
            const noResults = document.getElementById('noResults');
            
            if (filteredSnippets.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            
            grid.innerHTML = filteredSnippets.map((snippet, index) => `
                <div class="snippet-card">
                    <div class="snippet-header">
                        <span class="iconify snippet-icon" data-icon="${snippet.icon}"></span>
                        <div class="snippet-title">
                            <h3>${snippet.title}</h3>
                            <span class="snippet-category">${snippet.category}</span>
                        </div>
                    </div>
                    <p class="snippet-description">${snippet.description}</p>
                    <div class="code-block">
                        <pre><code>${snippet.code.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</code></pre>
                    </div>
                    <button class="copy-btn" onclick="copyCode(${index})">
                        <span class="iconify" data-icon="carbon:copy"></span>
                        Copy Code
                    </button>
                </div>
            `).join('');
        }

        function copyCode(index) {
            const code = snippets[index].code;
            navigator.clipboard.writeText(code).then(() => {
                const btn = document.querySelectorAll('.copy-btn')[index];
                const originalHTML = btn.innerHTML;
                btn.classList.add('copied');
                btn.innerHTML = '<span class="iconify" data-icon="carbon:checkmark"></span>Copied!';
                
                setTimeout(() => {
                    btn.classList.remove('copied');
                    btn.innerHTML = originalHTML;
                }, 2000);
            });
        }

        // Category filtering
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const category = btn.dataset.category;
                const filtered = category === 'all' 
                    ? snippets 
                    : snippets.filter(s => s.category === category);
                
                renderSnippets(filtered);
            });
        });

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const activeCategory = document.querySelector('.category-btn.active').dataset.category;
            
            let filtered = activeCategory === 'all' 
                ? snippets 
                : snippets.filter(s => s.category === activeCategory);
            
            if (search) {
                filtered = filtered.filter(s => 
                    s.title.toLowerCase().includes(search) ||
                    s.description.toLowerCase().includes(search) ||
                    s.code.toLowerCase().includes(search)
                );
            }
            
            renderSnippets(filtered);
        });

        // Initial render
        renderSnippets(snippets);
    </script>
</body>
</html>
